<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Search Result</title>
</head>
<body>
    <h1>검색 결과</h1>

    <!-- 결과가 있을 때 -->
    <ul th:if="${results != null and !#lists.isEmpty(results)}">
        <li th:each="gif : ${results}">
            <strong th:text="${gif.gifName}"></strong><br>
            <img th:src="@{'/files/' + ${gif.storedName}}" width="250"><br>

            <!-- 링크 복사 버튼 -->
            <button type="button"
                    onclick="copyLink('/files/[[${gif.storedName}]]')">링크 복사</button>

            <!-- 다운로드 버튼 -->
            <a th:href="@{'/download/' + ${gif.storedName}}">
                <button type="button">다운로드</button>
            </a>

            <!-- 기존 태그 / 사용자 표시 / 삭제 버튼 등 계속 -->
            <br><br>
        </li>
    </ul>

    <p th:if="${results == null or #lists.isEmpty(results)}" style="color:gray; font-size:18px;">
        검색 결과가 없습니다.
    </p>

    <div th:if="${totalPages > 1}">
        <div>
            <a th:if="${currentPage > 0}"
               th:href="@{|/search-result?q=${keyword}&page=${currentPage - 1}|}">
                이전
            </a>

            <span th:text="${currentPage + 1}"></span> /
            <span th:text="${totalPages}"></span>

            <a th:if="${currentPage < totalPages - 1}"
               th:href="@{|/search-result?q=${keyword}&page=${currentPage + 1}|}">
                다음
            </a>
        </div>
    </div>


    <a href="/search-page">검색 화면으로 돌아가기</a>

    <script th:inline="javascript">
        if ([[${msg != null}]]){
            alert([[${msg}]]);
        }
    </script>

    <script>
        function copyLink(path) {
            const fullUrl = window.location.origin + path;
            navigator.clipboard.writeText(fullUrl).then(() => {
                alert("링크가 복사되었습니다:\n");
            });
        }
    </script>
</body>
</html>
